<?php
include ("../../hpfmaster.inc");
if($handle=pg_connect($pgconnect)){
    pg_query($handle,"begin");
    $src = array(
	     "B=2000,N=1,M=2,P=100",
	     "B=117,N=1,M=3,P=100",
	     "B=127,N=1,M=1,P=100",
	     "B=2001,N=1,M=2,P=100",
	     "B=2002,N=1,M=3,P=100",
	     "B=2003,N=1,M=5,P=100",
	     "B=167,N=1,M=5,P=100",
	     "B=2004,N=1,M=3,P=100",
	     "B=2005,N=1,M=2,P=100",
	     "B=2007,N=1,M=4,P=100",
	     "B=3001,N=1,M=5,P=100",
	     "B=295,N=1,M=1,P=100",
	     "B=216,N=1,M=3,P=100",
	     "B=2008,N=1,M=3,P=100",
	     "B=2010,N=1,M=4,P=100",
	     "B=196,N=1,M=1,P=100",
	     "B=3002,N=1,M=5,P=100",
	     "B=2011,N=1,M=4,P=100",
	     "B=2012,N=1,M=2,P=100",
	     "B=2013,N=1,M=5,P=100",
	     "B=2014,N=1,M=3,P=100",
	     "B=2015,N=1,M=5,P=100",
	     "B=2016,N=1,M=1,P=100",
	     "B=2017,N=1,M=1,P=100",
	     "B=3003,N=1,M=6,P=100",
	     "B=2018,N=1,M=2,P=100",
	     "B=2019,N=1,M=6,P=100",
	     "B=727,N=1,M=4,P=100",
	     "B=521,N=1,M=3,P=100",
	     "B=3004,N=1,M=2,P=100",
	     "B=3005,N=1,M=2,P=100",
	     "B=66,N=1,M=1,P=100",
	     "B=2020,N=1,M=2,P=100",
	     "B=2021,N=1,M=3,P=100",
	     "B=2022,N=1,M=1,P=100",
	     "B=3006,N=1,M=4,P=100",
	     "B=2023,N=1,M=4,P=100",
	     "B=299,N=1,M=1,P=100",
	     "B=68,N=1,M=3,P=100",
	     "B=2024,N=1,M=4,P=100",
	     "B=566,N=1,M=3,P=100",
	     "B=777,N=1,M=2,P=100",
	     "B=290,N=1,M=4,P=100",
	     "B=2025,N=1,M=3,P=100",
	     "B=155,N=1,M=3,P=100",
	     "B=163,N=1,M=6,P=100",
	     "B=259,N=1,M=5,P=100",
	     "B=2026,N=1,M=3,P=100",
	     "B=2027,N=1,M=3,P=100",
	     "B=3007,N=1,M=4,P=100",
	     "B=2028,N=1,M=4,P=100",
	     "B=106,N=1,M=3,P=100",
	     "B=33,N=1,M=2,P=100",
	     "B=2030,N=1,M=3,P=100",
	     "B=411,N=1,M=4,P=100",
	     "B=201,N=1,M=2,P=100",
	     "B=2031,N=1,M=4,P=100",
	     "B=2032,N=1,M=6,P=100",
	     "B=2033,N=1,M=4,P=100",
	     "B=2034,N=1,M=1,P=100",
	     "B=3008,N=1,M=4,P=100",
	     "B=2035,N=1,M=3,P=100",
	     "B=2036,N=1,M=4,P=100",
	     "B=491,N=1,M=4,P=100",
	     "B=213,N=1,M=4,P=100",
	     "B=70,N=1,M=4,P=100",
	     "B=146,N=1,M=2,P=100",
	     "B=2037,N=1,M=5,P=100",
	     "B=522,N=1,M=5,P=100",
	     "B=2038,N=1,M=4,P=100",
	     "B=2039,N=1,M=3,P=100",
	     "B=2040,N=1,M=3,P=100",
	     "B=524,N=1,M=2,P=100",
	     "B=3009,N=1,M=2,P=100",
	     "B=88,N=1,M=3,P=100",
	     "B=23,N=1,M=3,P=100",
	     "B=2041,N=1,M=6,P=100",
	     "B=403,N=1,M=3,P=100",
	     "B=59,N=1,M=2,P=100",
	     "B=159,N=1,M=1,P=100",
	     "B=2043,N=1,M=4,P=100",
	     "B=2044,N=1,M=3,P=100",
	     "B=272,N=1,M=2,P=100",
	     "B=508,N=1,M=3,P=100",
	     "B=3010,N=1,M=1,P=100",
	     "B=90,N=1,M=1,P=100",
	     "B=2045,N=1,M=5,P=100",
	     "B=2047,N=1,M=5,P=100",
	     "B=34,N=1,M=4,P=100",
	     "B=322,N=1,M=4,P=100",
	     "B=2048,N=1,M=4,P=100",
	     "B=2049,N=1,M=1,P=100",
	     "B=145,N=1,M=2,P=100",
	     "B=289,N=1,M=4,P=100",
	     "B=154,N=1,M=1,P=100",
	     "B=533,N=1,M=4,P=100",
	     "B=2051,N=1,M=3,P=100",
	     "B=560,N=1,M=4,P=100",
	     "B=2052,N=1,M=6,P=100",
	     "B=313,N=1,M=5,P=100",
	     "B=2053,N=1,M=4,P=100",
	     "B=798,N=1,M=2,P=100",
	     "B=2055,N=1,M=5,P=100",
	     "B=3011,N=1,M=4,P=100",
	     "B=170,N=1,M=6,P=100",
	     "B=2057,N=1,M=3,P=100",
	     "B=763,N=1,M=4,P=100",
	     "B=165,N=1,M=3,P=100",
	     "B=2058,N=1,M=3,P=100",
	     "B=2059,N=1,M=4,P=100",
	     "B=3012,N=1,M=2,P=100",
	     "B=2060,N=1,M=3,P=100",
	     "B=2061,N=1,M=1,P=100",
	     "B=57,N=1,M=4,P=100",
	     "B=3013,N=1,M=4,P=100",
	     "B=93,N=1,M=1,P=100",
	     "B=2062,N=1,M=4,P=100",
	     "B=2063,N=1,M=1,P=100",
	     "B=515,N=1,M=3,P=100",
	     "B=613,N=1,M=5,P=100",
	     "B=2064,N=1,M=6,P=100",
	     "B=148,N=1,M=2,P=100",
	     "B=2065,N=1,M=3,P=100",
	     "B=103,N=1,M=1,P=100",
	     "B=302,N=1,M=6,P=100",
	     "B=2066,N=1,M=2,P=100",
	     "B=195,N=1,M=5,P=100",
	     "B=2067,N=1,M=4,P=100",
	     "B=2068,N=1,M=1,P=100",
	     "B=2069,N=1,M=5,P=100",
	     "B=2070,N=1,M=2,P=100",
	     "B=2072,N=1,M=4,P=100",
	     "B=2073,N=1,M=6,P=100",
	     "B=554,N=1,M=5,P=100",
	     "B=2074,N=1,M=5,P=100",
	     "B=31,N=1,M=4,P=100",
	     "B=500,N=1,M=3,P=100",
	     "B=517,N=1,M=2,P=100",
	     "B=232,N=1,M=4,P=100",
	     "B=2076,N=1,M=5,P=100",
	     "B=283,N=1,M=3,P=100",
	     "B=80,N=1,M=1,P=100",
	     "B=2077,N=1,M=2,P=100",
	     "B=2078,N=2,M=3,M=5,P=40,P=60",
	     "B=2,N=2,M=2,M=5,P=42,P=58",
	     "B=99,N=2,M=2,M=5,P=64,P=36",
	     "B=158,N=2,M=3,M=4,P=72,P=28",
	     "B=2079,N=2,M=1,M=5,P=77,P=23",
	     "B=124,N=2,M=2,M=5,P=21,P=79",
	     "B=2080,N=2,M=3,M=5,P=53,P=47",
	     "B=2081,N=2,M=3,M=4,P=56,P=44",
	     "B=2082,N=2,M=3,M=4,P=30,P=70",
	     "B=3014,N=2,M=5,M=6,P=55,P=45",
	     "B=2083,N=2,M=2,M=6,P=95,P=5",
	     "B=235,N=2,M=2,M=5,P=24,P=76",
	     "B=12,N=2,M=2,M=4,P=95,P=5",
	     "B=303,N=2,M=1,M=4,P=51,P=49",
	     "B=141,N=2,M=3,M=5,P=40,P=60",
	     "B=546,N=2,M=2,M=4,P=51,P=49",
	     "B=2084,N=2,M=3,M=5,P=29,P=71",
	     "B=128,N=2,M=1,M=6,P=82,P=18",
	     "B=2085,N=2,M=4,M=5,P=30,P=70",
	     "B=301,N=2,M=2,M=5,P=63,P=37",
	     "B=2086,N=2,M=3,M=5,P=57,P=43",
	     "B=310,N=2,M=3,M=4,P=73,P=27",
	     "B=239,N=2,M=2,M=4,P=66,P=34",
	     "B=50,N=2,M=2,M=4,P=58,P=42",
	     "B=162,N=2,M=2,M=5,P=68,P=32",
	     "B=561,N=2,M=4,M=5,P=69,P=31",
	     "B=2088,N=2,M=4,M=5,P=76,P=24",
	     "B=194,N=2,M=4,M=6,P=89,P=11",
	     "B=60,N=2,M=4,M=6,P=61,P=39",
	     "B=15,N=2,M=1,M=2,P=59,P=41",
	     "B=2089,N=2,M=3,M=4,P=24,P=76",
	     "B=465,N=2,M=2,M=4,P=25,P=75",
	     "B=778,N=2,M=2,M=5,P=63,P=37",
	     "B=25,N=2,M=2,M=4,P=88,P=12",
	     "B=2091,N=2,M=3,M=5,P=28,P=72",
	     "B=4,N=2,M=3,M=4,P=78,P=22",
	     "B=82,N=2,M=2,M=4,P=46,P=54",
	     "B=260,N=2,M=3,M=5,P=88,P=12",
	     "B=120,N=2,M=3,M=4,P=76,P=24",
	     "B=152,N=2,M=2,M=4,P=74,P=26",
	     "B=189,N=2,M=2,M=4,P=92,P=8",
	     "B=87,N=2,M=3,M=5,P=82,P=18",
	     "B=64,N=2,M=2,M=6,P=95,P=5",
	     "B=3015,N=2,M=2,M=6,P=40,P=60",
	     "B=2092,N=2,M=2,M=3,P=55,P=45",
	     "B=2093,N=2,M=1,M=4,P=67,P=33",
	     "B=174,N=2,M=2,M=5,P=44,P=56",
	     "B=2094,N=2,M=2,M=3,P=25,P=75",
	     "B=2095,N=2,M=2,M=3,P=87,P=13",
	     "B=153,N=2,M=2,M=4,P=76,P=24",
	     "B=740,N=2,M=1,M=3,P=77,P=23",
	     "B=2096,N=2,M=1,M=6,P=39,P=61",
	     "B=308,N=2,M=2,M=4,P=27,P=73",
	     "B=2097,N=2,M=2,M=5,P=87,P=13",
	     "B=305,N=2,M=1,M=4,P=75,P=25",
	     "B=177,N=2,M=3,M=4,P=40,P=60",
	     "B=217,N=2,M=3,M=5,P=33,P=67",
	     "B=792,N=2,M=1,M=3,P=46,P=54",
	     "B=294,N=2,M=4,M=6,P=56,P=44",
	     "B=3016,N=2,M=1,M=4,P=68,P=32",
	     "B=107,N=2,M=5,M=6,P=64,P=36",
	     "B=143,N=2,M=2,M=4,P=84,P=16",
	     "B=2098,N=2,M=3,M=5,P=75,P=25",
	     "B=306,N=2,M=1,M=3,P=36,P=64",
	     "B=22,N=2,M=3,M=5,P=93,P=7",
	     "B=3017,N=2,M=1,M=4,P=50,P=50",
	     "B=300,N=2,M=3,M=5,P=64,P=36",
	     "B=2099,N=2,M=2,M=6,P=45,P=55",
	     "B=20,N=2,M=3,M=4,P=77,P=23",
	     "B=160,N=2,M=2,M=4,P=64,P=36",
	     "B=2101,N=2,M=1,M=6,P=49,P=51",
	     "B=53,N=2,M=3,M=4,P=47,P=53",
	     "B=197,N=2,M=2,M=4,P=64,P=36",
	     "B=2102,N=2,M=1,M=5,P=49,P=51",
	     "B=161,N=2,M=3,M=6,P=29,P=71",
	     "B=318,N=2,M=1,M=4,P=55,P=45",
	     "B=2103,N=2,M=4,M=6,P=42,P=58",
	     "B=96,N=2,M=2,M=6,P=38,P=62",
	     "B=2104,N=3,M=2,M=3,M=4,P=35,P=43,P=22",
	     "B=21,N=3,M=2,M=4,M=6,P=81,P=8,P=11",
	     "B=188,N=3,M=2,M=3,M=4,P=17,P=23,P=60",
	     "B=147,N=3,M=1,M=2,M=5,P=15,P=58,P=27",
	     "B=144,N=3,M=1,M=3,M=5,P=4,P=23,P=73",
	     "B=2105,N=3,M=1,M=2,M=6,P=26,P=56,P=18",
	     "B=2106,N=3,M=1,M=2,M=4,P=32,P=1,P=67",
	     "B=92,N=3,M=2,M=3,M=4,P=41,P=45,P=14",
	     "B=18,N=3,M=2,M=3,M=4,P=53,P=39,P=8",
	     "B=2107,N=3,M=1,M=3,M=6,P=58,P=13,P=29",
	     "B=2108,N=3,M=1,M=3,M=4,P=50,P=9,P=41",
	     "B=19,N=3,M=2,M=3,M=6,P=82,P=12,P=6",
	     "B=779,N=3,M=2,M=3,M=5,P=3,P=48,P=49",
	     "B=49,N=3,M=1,M=2,M=4,P=23,P=71,P=6",
	     "B=542,N=3,M=1,M=2,M=4,P=12,P=47,P=41",
	     "B=2109,N=3,M=4,M=5,M=6,P=62,P=5,P=33",
	     "B=17,N=3,M=2,M=3,M=4,P=88,P=4,P=8",
	     "B=551,N=3,M=2,M=3,M=5,P=41,P=37,P=22",
	     "B=110,N=3,M=2,M=4,M=5,P=90,P=5,P=5",
	     "B=140,N=3,M=2,M=4,M=5,P=44,P=53,P=3",
	     "B=2110,N=3,M=3,M=4,M=5,P=52,P=26,P=22",
	     "B=248,N=3,M=1,M=2,M=4,P=3,P=36,P=61",
	     "B=2111,N=3,M=1,M=3,M=6,P=44,P=35,P=21",
	     "B=79,N=3,M=2,M=3,M=4,P=91,P=3,P=6",
	     "B=137,N=3,M=2,M=3,M=4,P=56,P=35,P=9",
	     "B=6,N=3,M=1,M=2,M=4,P=38,P=43,P=19",
	     "B=558,N=3,M=2,M=3,M=4,P=36,P=17,P=47",
	     "B=77,N=3,M=3,M=4,M=5,P=28,P=9,P=63",
	     "B=269,N=3,M=1,M=2,M=4,P=77,P=16,P=7",
	     "B=52,N=3,M=1,M=2,M=6,P=46,P=4,P=50",
	     "B=404,N=4,M=2,M=3,M=4,M=6,P=87,P=4,P=4,P=5",
	     "B=84,N=4,M=1,M=2,M=3,M=5,P=2,P=44,P=28,P=26",
	     "B=172,N=4,M=1,M=2,M=3,M=4,P=19,P=14,P=26,P=41",
	     "B=116,N=4,M=1,M=2,M=3,M=4,P=2,P=36,P=16,P=46",
	     "B=293,N=4,M=1,M=2,M=3,M=4,P=20,P=20,P=26,P=34",
	     "B=134,N=4,M=2,M=3,M=4,M=6,P=3,P=45,P=3,P=49",
	     "B=62,N=4,M=2,M=3,M=4,M=5,P=76,P=13,P=8,P=3",
	     "B=184,N=4,M=2,M=3,M=5,M=6,P=65,P=10,P=15,P=10",
	     "B=514,N=4,M=2,M=3,M=4,M=6,P=34,P=15,P=41,P=10",
	     "B=164,N=4,M=2,M=3,M=4,M=5,P=26,P=29,P=13,P=32",
	     "B=735,N=4,M=1,M=2,M=3,M=4,P=9,P=13,P=23,P=55",
	     "B=38,N=5,M=2,M=3,M=4,M=5,M=6,P=20,P=21,P=33,P=22,P=4",
	     "B=67,N=5,M=2,M=3,M=4,M=5,M=6,P=16,P=24,P=16,P=26,P=18",
	     "B=16,N=5,M=1,M=2,M=3,M=5,M=6,P=15,P=31,P=11,P=32,P=11",
	     "B=81,N=5,M=1,M=2,M=3,M=4,M=6,P=5,P=23,P=23,P=29,P=20",
	     "B=1,N=5,M=1,M=3,M=4,M=5,M=6,P=1,P=33,P=15,P=50,P=1",
	     "B=704,N=5,M=1,M=2,M=3,M=4,M=6,P=9,P=21,P=4,P=53,P=13",
	     "B=27,N=5,M=1,M=2,M=3,M=5,M=6,P=15,P=7,P=61,P=16,P=1",
	     "B=317,N=6,M=1,M=2,M=3,M=4,M=5,M=6,P=8,P=20,P=24,P=14,P=17,P=17",
	     "B=752,N=6,M=1,M=2,M=3,M=4,M=5,M=6,P=6,P=19,P=15,P=5,P=32,P=23",
	     "B=14,N=6,M=1,M=2,M=3,M=4,M=5,M=6,P=28,P=5,P=21,P=14,P=4,P=28",
	     "B=746,N=6,M=1,M=2,M=3,M=4,M=5,M=6,P=2,P=25,P=42,P=5,P=13,P=13",
	     );

    $id = 1000;
    for($s = 0; $s<2; $s++){
    for($a=0,$b=count($src); $b--; $a++,$id++){
	$dst = explode(",",$src[$a]);
	$code = substr($dst[0],2);
	$pays  = substr($dst[1],2);
	printf("src[%03d] = [%s] brand=[%d]\n",$a,$src[$a],$code);

	$query = sprintf("select * from brand where vf=true and code='%d'",$code);
	$br = pg_query($handle,$query);
	$bo = pg_fetch_array($br);
	$brand = $bo['id'];
	if($brand){
	    $query = sprintf("insert into estimate(id,stype,pays,brand) values('%d','%d','%d','%d')",$id,$s+1,$pays,$brand);
	    $qr = pg_query($handle,$query);
//-------------------------------------------------------------------------
	    $yoffset = array();
	    $month = array();
	    $percentage = array();
	    
	    $m = 2;
	    $p = 2+$pays;
	    for($c=0; $c<$pays; $c++){
		$yoffset[] = 0;
		$month[] = substr($dst[$m+$c],2) + ($s*6);
		$percentage[] = substr($dst[$p+$c],2);
	    }
	    $query = sprintf("update estimate set yoffset='{%s}',month='{%s}',percentage='{%s}' where id='%d'",
			     implode(",",$yoffset),
			     implode(",",$month),
			     implode(",",$percentage),
			     $id
			     );
	    $qr = pg_query($handle,$query);
//-------------------------------------------------------------------------
	}
    }
    }
    pg_query($handle,"commit");
    pg_close($handle);
}
?>
	
